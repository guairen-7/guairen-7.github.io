<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>【实验四】【使用Select 语句查询数据】 │ AXDLMG7's Blog</title><link rel="stylesheet" href="/css/oasis.css"><meta name="generator" content="Hexo 5.4.1"></head><body><div id="content"><h1 id="title">【实验四】【使用Select 语句查询数据】</h1><div id="menu-outer"><nav id="menu-inner"><a id="menu-back" href="javascript:history.back()">Back</a><time datetime="2022-05-09T04:25:24.461Z">2022-05-09</time></nav></div><div id="content-outer"><div id="content-inner"><article id="post"><h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><p>这里为了体现查询语句的效果，下面根据查询语句的要求设计数据，结果如下：</p>
<p>KC表：<br><img src="https://img-blog.csdnimg.cn/fc6a4d265ebd44019ce0e03c1888ab80.png" alt="在这里插入图片描述"></p>
<p>XSQK表：<br><img src="https://img-blog.csdnimg.cn/5717881a16c74156b5022b9b7108014e.png" alt="在这里插入图片描述"></p>
<p>XS_KC表：<br><img src="https://img-blog.csdnimg.cn/4675f71999244586a8797e3d2951a128.png" alt="在这里插入图片描述"></p>
<ol>
<li>打开“SQL Server Management Studio”窗口。</li>
<li>单击“标准”工具栏的“新建查询”按钮，打开“查询编辑器”窗口</li>
<li>在窗口中输入以下SQL查询命令并执行：<h2 id="一、简单查询"><a href="#一、简单查询" class="headerlink" title="一、简单查询"></a>一、简单查询</h2>a.在KC表中，查询第2学期开课的课程、授课教师<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  课程名, 授课教师, 开课学期</span><br><span class="line"><span class="keyword">from</span>  kc</span><br><span class="line"><span class="keyword">where</span>  开课学期<span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>
<img src="https://img-blog.csdnimg.cn/7467004fc99e433585d62a24bafebad4.png" alt="在这里插入图片描述"></li>
</ol>
<p>b.在XSQK表中，查询女同学的姓名和电话号码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  姓名, 性别, 联系电话</span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">where</span>  性别<span class="operator">=</span><span class="string">&#x27;女&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/ad4341308b174e149f77264f2d01f095.png" alt="在这里插入图片描述"></p>
<p>c.在XS_KC表中，查询成绩在80分以上的学号、课程号和成绩</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, 课程号, 成绩</span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">where</span>  成绩<span class="operator">&gt;=</span><span class="number">80</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/e6ce1db621b84cbc9d8307a58877c2af.png" alt="在这里插入图片描述"></p>
<p>d.在XS_KC表中，查询在80以上和不及格学生的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, 课程号, 成绩</span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">where</span>  成绩<span class="operator">&gt;=</span><span class="number">80</span>  <span class="keyword">or</span> 成绩<span class="operator">&lt;</span><span class="number">60</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/96dadb6635fa4114ac919a1219578d21.png" alt="在这里插入图片描述"></p>
<p>e.在XSQK表中，查询不在1980年7、8、9月出生的学生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, 姓名, 出生日期</span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">where</span>  出生日期 <span class="keyword">not</span>  <span class="keyword">between</span> <span class="string">&#x27;1980-07-07&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1980-09-30&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/0b329ba9e5484087af2cc875db7d0923.png" alt="在这里插入图片描述"></p>
<p>f. 在XSQK表中，查询陈姓且单名的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">where</span>  姓名  <span class="keyword">like</span>  <span class="string">&#x27;陈_&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/6e1e7031e77540a986b7f5858cbe1b00.png" alt="在这里插入图片描述"></p>
<p>g.在XSQK表中，查询学号中含有1的记录信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">where</span>  学号 <span class="keyword">like</span> <span class="string">&#x27;%1%&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/cef4f9640fb8451ca3c0c4400b8416aa.png" alt="在这里插入图片描述"></p>
<p>h.在XSQK表中，查询电话号码中非末位含有4或6的记录信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">where</span>  联系电话  <span class="keyword">like</span>  <span class="string">&#x27;%[4,6]%[^4,6]&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/a6e02085acaf4a3280a3656554e3ee3c.png" alt="在这里插入图片描述"></p>
<p>i.在KC表中，查询第一、三、五学期开设的课程信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>  kc</span><br><span class="line"><span class="keyword">where</span>  开课学期 <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/a8e13f3540a14bbba1633da52d41f8d3.png" alt="在这里插入图片描述"></p>
<p>j.查询XSQK表，输出学号、姓名、出生日期、并使查询结构按出生日期升序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 学号, 姓名, 出生日期</span><br><span class="line"><span class="keyword">from</span>  xsqk    <span class="keyword">order</span>  <span class="keyword">by</span>  出生日期</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/1399385dfc7040a695400b962d60f9ca.png" alt="在这里插入图片描述"></p>
<h2 id="二、汇总查询"><a href="#二、汇总查询" class="headerlink" title="二、汇总查询"></a>二、汇总查询</h2><p>a.在KC表中，统计每学期的总分数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  开课学期, <span class="built_in">sum</span>(学分)  <span class="keyword">as</span>  <span class="string">&#x27;各学期的学分合计&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  kc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  开课学期</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/3b9cecf0e6ba4087b7d6d859a40f5064.png" alt="在这里插入图片描述"></p>
<p>b.在XS_KC表中，统计每个学生的选修课程的门数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, <span class="built_in">count</span>(<span class="operator">*</span>)  <span class="keyword">as</span>  <span class="string">&#x27;每个学生选修的课程门数&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  学号</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/b4b5d80e5c9a43efbad02f71ce78ee75.png" alt="在这里插入图片描述"></p>
<p>c.将XS_KC表中的数据记录按学号分类汇总，输出学号和平均分</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 学号, <span class="built_in">avg</span>(成绩)  <span class="keyword">as</span>  <span class="string">&#x27;学生的平均分&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  学号</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/c7e79f10bb044418ac766f630d47795e.png" alt="在这里插入图片描述"></p>
<p>d.查询平均分大于70且小于80的学生学号和平均分</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, <span class="built_in">avg</span>(成绩)  <span class="keyword">as</span>  <span class="string">&#x27;学生的平均分&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  学号</span><br><span class="line"><span class="keyword">having</span>  <span class="built_in">avg</span>(成绩)  <span class="keyword">between</span>  <span class="number">70</span>  <span class="keyword">and</span>  <span class="number">80</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/23f4687a30624ad6a4e4117435719a36.png" alt="在这里插入图片描述"></p>
<p>e.查询XS_KC表，输出学号、课程号、成绩，并使查询结果首先按照课程号的升序排列，当课程号相同时再按照成绩降序排列，并将查询结果保存到新表TEMP_KC中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, 课程号, 成绩</span><br><span class="line"><span class="keyword">into</span>  temp_kc</span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>  课程号, 成绩 <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/53fd9b1835494d7ba86f0f20ef861196.png" alt="在这里插入图片描述"><br>这里因为数据没有考虑周全，<strong>暂时没有体现</strong>“当课程号相同时再按照成绩降序排列”。</p>
<p>f.查询选修了“101”课程的学生的最高分和最低分</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="built_in">max</span>(成绩)  <span class="keyword">as</span>  <span class="string">&#x27;101课程的最高分&#x27;</span>, <span class="built_in">min</span>(成绩)  <span class="keyword">as</span>  <span class="string">&#x27;101课程的最低分&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">where</span>  课程号<span class="operator">=</span><span class="string">&#x27;101&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/fe4f1bdcfc7c49b4894d7bef5f2e1d76.png" alt="在这里插入图片描述"></p>
<p>g.统计每个学期所开设的课程门数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  开课学期, <span class="built_in">count</span>(<span class="operator">*</span>)  <span class="keyword">as</span>  <span class="string">&#x27;每学期开设的课程门数&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  kc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  开课学期</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/aa897084859e402cb0e0c110c75baed6.png" alt="在这里插入图片描述"></p>
<p>h.查询各专业的学生人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  专业名, <span class="built_in">count</span>(专业名)  <span class="keyword">as</span>  <span class="string">&#x27;各专业人数&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  专业名</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/e465ce2fb8d14a788297b5ccd2ca4873.png" alt="在这里插入图片描述"></p>
<h2 id="三、连接查询和子查询"><a href="#三、连接查询和子查询" class="headerlink" title="三、连接查询和子查询"></a>三、连接查询和子查询</h2><p>a.查询不及格学生的学号、课程名、授课教师、开课学期的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, xs_kc.课程号, 授课教师, 开课学期, 成绩</span><br><span class="line"><span class="keyword">from</span>  kc, xs_kc</span><br><span class="line"><span class="keyword">where</span>  kc.课程号<span class="operator">=</span>xs_kc.课程号  <span class="keyword">and</span> 成绩<span class="operator">&lt;</span><span class="number">60</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/1cea0fac98b74262a7544837f61d2f76.png" alt="在这里插入图片描述"></p>
<p>b.按学号分组汇总总分高于100的学生记录，并按总分的降序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, <span class="built_in">sum</span>(成绩)  <span class="keyword">as</span>  <span class="string">&#x27;各学生的总分&#x27;</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  学号</span><br><span class="line"><span class="keyword">having</span>  <span class="built_in">sum</span>(成绩)<span class="operator">&gt;=</span><span class="number">100</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>  <span class="built_in">sum</span>(成绩)  <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/3140de8a9cb342fab6c880133bf5376a.png" alt="在这里插入图片描述"></p>
<p>c.使用子查询求恰好有两门课程不及格的学生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  学号, 姓名</span><br><span class="line"><span class="keyword">from</span>  xsqk</span><br><span class="line"><span class="keyword">where</span>  (<span class="keyword">select</span>  <span class="built_in">count</span>(课程号)</span><br><span class="line"><span class="keyword">from</span>  xs_kc</span><br><span class="line"><span class="keyword">where</span>   xsqk.学号<span class="operator">=</span>xs_kc.学号 <span class="keyword">and</span> 成绩<span class="operator">&lt;=</span><span class="number">60</span> )<span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4b8d52493b9e42b4b8ae80cfbdbc5758.png" alt="在这里插入图片描述"></p>
<p>d.使用子查询查询每门课程的最高分的学生记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc  a</span><br><span class="line"><span class="keyword">where</span> 成绩<span class="operator">=</span>(<span class="keyword">select</span>  <span class="built_in">max</span>(成绩)</span><br><span class="line"><span class="keyword">from</span>  xs_kc  b</span><br><span class="line"><span class="keyword">where</span>  b.课程号<span class="operator">=</span>a.课程号)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/c6f8c8c66efa4398a2f687e9a82984fc.png" alt="在这里插入图片描述"></p>
<p>e.使用子查询查询每个学生的最低分的课程记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>  xs_kc  a</span><br><span class="line"><span class="keyword">where</span> 成绩<span class="operator">=</span>(<span class="keyword">select</span>  <span class="built_in">min</span>(成绩)</span><br><span class="line"><span class="keyword">from</span>  xs_kc  b</span><br><span class="line"><span class="keyword">where</span>  b.学号<span class="operator">=</span>a.学号)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/7d967cb09c09421a8a65d825202467e0.png" alt="在这里插入图片描述"></p>
<div class="post-tags"><a class="post-tag-link" href="/tags/SSMS/" rel="tag">#SSMS</a>, <a class="post-tag-link" href="/tags/T-SQL/" rel="tag">#T-SQL</a>, <a class="post-tag-link" href="/tags/%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5/" rel="tag">#查询语句</a></div></article><div id="paginator"></div></div></div><div id="bottom-outer"><div id="bottom-inner"><hr><div><div><a>2022@ </a><a href="/atom.xml"><img src="/assets/rss.png"></a></div><div id="hexo"><a>Powered by&nbsp</a><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><a>&nbsp&&nbsp</a><a target="_blank" rel="noopener" href="https://github.com/qiantao94/hexo-theme-oasis">Oasis</a></div></div></div></div></div></body><script src="/js/oasis.js"></script></html>