<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="" />
  <meta name="author" content="AXDLMG7" />
  <meta name="description" content="" />
  
  
  <title>
    
      【R语言编程基础】【课后习题答案】【全】 
      
      
    
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto:400,400italic,600|Roboto+Mono" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/common.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">


  

  
    
<link rel="stylesheet" href="/css/post.css">

  

  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


<meta name="generator" content="Hexo 5.4.1"></head>


  <body>
    <div id="app">
      <div class="header">
  <a href="/">LEEDOM</a>
</div>


      <p class="links">
  
    <a title="archives" target="" href="/archives/">
      <i class="iconfont icon-bookmark"></i>
    </a>
  
    <a title="github" target="_blank" href="https://github.com/leedom92/hexo-theme-leedom">
      <i class="iconfont icon-github"></i>
    </a>
  
    <a title="email" target="" href="">
      <i class="iconfont icon-envelope"></i>
    </a>
  
    <a title="facebook" target="" href="">
      <i class="iconfont icon-facebooksquare"></i>
    </a>
  
    <a title="twitter" target="" href="">
      <i class="iconfont icon-twitter"></i>
    </a>
  
    <a title="wechat" target="" href="">
      <i class="iconfont icon-wechat"></i>
    </a>
  
    <a title="weibo" target="" href="">
      <i class="iconfont icon-weibo"></i>
    </a>
  
    <a title="rss" target="_blank" href="/atom.xml">
      <i class="iconfont icon-rss"></i>
    </a>
  
</p>


      <div class="main">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->

<!-- LaTex Display -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>

<div class="post">
  <h3 class="date">
    Oct 05, 2022
  </h3>
  <h1>
    【R语言编程基础】【课后习题答案】【全】
  </h1>
  <div class="content markdown-body">
    <p><img src="https://img-blog.csdnimg.cn/62a163842b854e0897846f6a05c61c0c.jpeg#pic_center" alt="在这里插入图片描述"></p>
<h1 id="第1章-R语言概述"><a href="#第1章-R语言概述" class="headerlink" title="第1章 R语言概述"></a>第1章 R语言概述</h1><h2 id="1-选择题"><a href="#1-选择题" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)多行注释的快捷键是（C）。<br>A.Ctrl+Shin+N<br>B.Ctrl+N<br>C.Ctrl+Shin+C<br>D.Ctrl+C</p>
<p>（2)以下函数不能直接查看plot函数的帮助文档的是（B）。<br>A. ?plot<br>B.??plot<br>C.help(plot)<br>D.help(plot)</p>
<p>（3)以下R包的加载方式正确的是（A）。<br>A.install.package 函数<br>B.library 函数<br>C..libPaths 函数<br>D.install 函数</p>
<p>（4)以下R包中不能调用分类算法的是（D）。<br>A.nnet包<br>B.e1071包<br>C.tree包<br>D.arules包</p>
<h2 id="2-操作题"><a href="#2-操作题" class="headerlink" title="2.操作题"></a>2.操作题</h2><p>（1)依据1.1节的R下载及安装方法，在计算机上安装R,通过熟悉基本操作的命令及操作界面，掌握软件的使用方法。<br>（2)依据1.2节的RStudio下载及安装方法，在计算机上安装RStudio,并尝试通过帮助文档学习使用plot函数绘制简单的散点图。<br>（3)依据1.3节的R包下载及安装方法，在计算机上安装DT包（用于创建交互式表格），并在命令运行窗口运行命令 datatable(iris),将得到交互式表格，如图1-29所示。</p>
<p><strong>图1-29 iris数据集的交互式表格</strong><br>（4)依据1.4节内容，加载boot包中的acme数据集，并查看acme数据集的前6项。同时，通过help函数查看acme数据集的数据含义并进行说明。</p>
<h1 id="第2章-数据对象与数据读写"><a href="#第2章-数据对象与数据读写" class="headerlink" title="第2章 数据对象与数据读写"></a>第2章 数据对象与数据读写</h1><h2 id="1-选择题-1"><a href="#1-选择题-1" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)下列可以判别字符型数据的函数是（A）。<br>A. is.numeric<br>B. is.logical<br>C. is.character<br>D.is.na<br>（2)下列可以判别数值型数据的函数是（D）。<br>A. is.complex<br>B. is.na<br>C.is.integer<br>D. is.numeric</p>
<p>（3)可将对象转换为逻辑型数据的函数是（D）。<br>A. as.character<br>B. is.numeric<br>C.as.logica<br>D. as.complex</p>
<p>（4)下列选项不是逻辑型数据的是（C）。<br>A.T<br>B.F<br>C.NA<br>D.10</p>
<p>（5)下列可以求矩阵的特征值和特征向量的函数是（B）。<br>A. diag<br>B. eigen<br>C.solve<br>D. det</p>
<p>（6)下列选项中可以使得列表转换为向量的是（D）。<br>A. as.matrix<br>B. as.data.frame<br>C. as.list<br>D. unlist</p>
<p>（7)下列用来转换数据框的函数是（B）。<br>A. as.list<br>B. as.matrix<br>C. as.data.frame<br>D. as.vector</p>
<p>（8)下列用键盘导人数据的函数是（B）。<br>A.read.table<br>B. read.csv<br>C.edit<br>D.readHTMLTable</p>
<p>（9)RODBC包中向数据库提交一个查询，并返回结果的函数是（B）。<br>A.odbcConnect<br>B.sqlFetch<br>C. sqlQuery<br>D. sqlDrop</p>
<p>（10)抓取网页上的表格，可使用XML包的是（D）函数。<br>A.read.csv<br>B. read.table<br>C.read.xlsx<br>D. read HTMLTable</p>
<h2 id="2-操作题-1"><a href="#2-操作题-1" class="headerlink" title="2.操作题"></a>2.操作题</h2><p>（1)创建一个对象，并进行数据类型的转换、判别等操作，步骤如下：<br>①创建一个对象x，内含元素为序列：1，3，5，6，8<br>②判断对象x是否是数值型数据<br>③将对象转换为逻辑数据，记为x1<br>④判断x1是否为逻辑型数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题(1)</span></span><br><span class="line">x&lt;-<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">8</span>)   <span class="comment">#创建一个对象x</span></span><br><span class="line"><span class="built_in">is.numeric</span>(x)    <span class="comment">#判断x是否是数值型数据</span></span><br><span class="line">x1&lt;-<span class="built_in">as.logical</span>(x)  <span class="comment">#将对象转化为逻辑型数据</span></span><br><span class="line"><span class="built_in">is.logical</span>(x1)  <span class="comment">#判断是否为逻辑型数据</span></span><br></pre></td></tr></table></figure>

<p>（2)创建多种数据结构，并进行数据结构的转换、索引、扩展等编辑操作，步骤如下：<br>①设置工作空间目录<br>②创建一个向量x，内含元素为序列：11，23，25，46，38，30，59，47，21，67<br>③查询向量x中序号为23和46的元素，查询向量x中大于等于50的元素的位置。<br>④创建一个重复因子序列Species：水平数为3，各水平重复两次，序列长度为5；3个水平为setosa、versicolor、virginica<br>⑤创建一个5行2列的矩阵，元素为向量x，按列填充<br>⑥将矩阵写入数据框data_iris，更改列名为Sepal.Length、Sepal.Width<br>⑦将数据框data_iris保存为TXT文件，保存到工作空间的test目录下<br>⑧将数据框data_iris转换为向量y<br>⑨判断是否转换成功</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题(2)</span></span><br><span class="line">setwd(<span class="string">&quot;./第2章 数据对象与数据读写/02-习题程序/code&quot;</span>)                    <span class="comment">#设置工作科技目录</span></span><br><span class="line">x&lt;-<span class="built_in">c</span>(<span class="number">11</span>,<span class="number">23</span>,<span class="number">25</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">59</span>,<span class="number">47</span>,<span class="number">21</span>,<span class="number">67</span>)     <span class="comment">#创建向量x</span></span><br><span class="line">x[<span class="built_in">c</span>(<span class="number">2</span>,<span class="number">4</span>)]                           <span class="comment">#查询向量中第2，第4位置的元素</span></span><br><span class="line">which(x&gt;<span class="number">35</span>&amp; x&lt;=<span class="number">50</span>)                <span class="comment">#查询x中大于35小于等于50元素的位置</span></span><br><span class="line"><span class="comment">#创建一个重复因子序列</span></span><br><span class="line">Species&lt;-<span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;setosa&quot;</span>,<span class="string">&quot;versicolor&quot;</span>,<span class="string">&quot;virginica&quot;</span>),each=<span class="number">2</span>,length.out=<span class="number">5</span>)   a&lt;-matrix(x,<span class="number">5</span>,<span class="number">2</span>)                    <span class="comment">#创建一个元素为x的矩阵</span></span><br><span class="line"><span class="comment">#将矩阵写入数据框data_iris并更改列名</span></span><br><span class="line">data_iris&lt;-data.frame(Sepal.Length=a[,<span class="number">1</span>],Sepal.Width=a[,<span class="number">2</span>])</span><br><span class="line">write.table(data_iris,<span class="string">&quot; ./data_iris.txt&quot;</span>)  <span class="comment">#将数据框保存为txt文件</span></span><br><span class="line"><span class="comment">#将数据框转化为向量y</span></span><br><span class="line">b&lt;-as.matrix(data_iris)</span><br><span class="line">y&lt;-as.vector(b)</span><br><span class="line">is.vector(y)   <span class="comment">#判断是否为向量</span></span><br></pre></td></tr></table></figure>

<p>（3)读取TXT文件，进行编辑操作，再写入另外一个CSV文件中，步骤如下：<br>①读取保存再test目录下的TXT文件data_iris<br>②将R的示例数据集iris中的第6~10行写入数据框data_iris1中<br>③将数据框data_iris与data_iris1合并为数据框data_iris2，并保存在CSV文件所在的目录下</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题(3)</span></span><br><span class="line">read.table(<span class="string">&quot;./第2章 数据对象与数据读写/02-习题程序/code/data_iris.txt&quot;</span>)  <span class="comment">#读取txt文件data_iris</span></span><br><span class="line">data_iris1&lt;-data.frame(iris[<span class="number">6</span>:<span class="number">10</span>,])     <span class="comment">#将数据集iris中第6到10行写入数据框</span></span><br><span class="line"><span class="comment">#将数据框data_iris和data_iris1合并为data_iris2</span></span><br><span class="line">data_iris2&lt;-cbind(data_iris,data_iris1)   </span><br><span class="line"><span class="comment">#将数据框data_iris2保存为csv文件</span></span><br><span class="line">write.csv(data_iris2,<span class="string">&quot;./第2章 数据对象与数据读写/02-习题程序/code/data_iris2.csv&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="第3章-数据集基本处理"><a href="#第3章-数据集基本处理" class="headerlink" title="第3章 数据集基本处理"></a>第3章 数据集基本处理</h1><h2 id="1-选择题-2"><a href="#1-选择题-2" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)下列不属于用于修改变量名的函数是（C）。<br>A. rename 函数<br>B.names 函数<br>C.name函数<br>D.colnames 函数</p>
<p>（2)下列用于修改矩阵变量名的函数是（B）。<br>A.rename函数<br>B.colnames 函数<br>C.names 函数<br>D.name函数</p>
<p>（3)下列属于as.Date函数功能的选项是（A）。<br>A.将字符串形式的日期值转换为日期变量<br>B.返回系统当前的日期<br>C.将字符申转换为包含时间及时区的日期变量<br>D.将日期变量转换成指定格式的字符型变量</p>
<p>（4)下列关于合并数据集不正确的选项是（C）。<br>A.数据框的合并可以通过rbind函数和cbind函数<br>B.rbind函数的自变量的宽度（列数）应该与原数据框的宽度相等<br>C.rbind函数的自变量的高度（行数）应该与原数据框的宽度相等<br>D.cbind函数的自变量的高度（行数）应该与原数据框的高度相等</p>
<p>（5)下列不属于sample函数功能的是（B）。<br>A.放回随机抽样<br>B.函数排序<br>C.可对数据进行随机分组<br>D.不放回随机抽样</p>
<p>（6)下列关于subset函数表达的错误选项是（D）。<br>A.可用来选取变量与观测变量<br>B.其中x是所要选择的数据框<br>C.subset是所要查看信息的方法<br>D.select查看的某个区域可以大于数据框x</p>
<p>（7)使用merge函数合并数据时，下列为默认值的是（B）。<br>A.相同列名的列<br>B.相同行名的行<br>C.第1列数据<br>D.第1行数据</p>
<p>（8)使用mell函数操作n维数组时，返回的结果有（A）列。<br>D.n+2<br>A.n<br>B.n+1<br>C.n-1</p>
<p>（9)元字符·的含义为（B）。<br>A.前面的字符或表达式重复零次或更多次<br>B.前面的字符或表达式重复一次或更多次<br>C.前面的字符或表达式重复零次或一次<br>D.前面的字符或表达式重复零次</p>
<p>（10)下列关于paste函数表达错误的选项是（D）。<br>A.参数sep表示分隔符，默认为空格<br>B.参数 collapse不指定值时，返回值是自变量之间通过sep指定的分隔符连接后得到的一个字符型向量<br>C.参数 collapse指定了特定的值，则自变量连接后的字符型向量会再被连接成一个字符申，之间通过collapse的值分隔<br>D.设置collapse参数，返回值为字符向量</p>
<h2 id="2-操作题-2"><a href="#2-操作题-2" class="headerlink" title="2.操作题"></a>2.操作题</h2><p>（1)创建一个矩阵，并使用交互式编辑器修改变量名；创建一个数据框，并在数据框中添加3个新变量，分别为原数据的差、乘积和余数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（1）</span></span><br><span class="line">a&lt;-matrix(<span class="number">1</span>:<span class="number">12</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">fix(a)</span><br><span class="line">a&lt;-<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">b&lt;-<span class="built_in">c</span>(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">x1&lt;-data.frame(a,b,d=a-b,e=a*b,f=a%%b)</span><br><span class="line">x1</span><br></pre></td></tr></table></figure>

<p>（2)构建一个含有缺失值的数据框，检测该数据框是否含有缺失值并删除包含缺失值的行；创建一个字符串的日期值，分别使用as.Date 函数、as.POSIXIt 函数、strptime 函数转换为日期变量；使用sort函数对score的Chinese列进行从大到小排列，并且把缺失值放在最后。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（2）</span></span><br><span class="line">x2&lt;-data.frame(id=<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),name=<span class="built_in">c</span>(<span class="string">&quot;张三&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王五&quot;</span>,<span class="string">&quot;赵六&quot;</span>),</span><br><span class="line">               math=<span class="built_in">c</span>(<span class="number">70</span>,<span class="number">89</span>,<span class="literal">NA</span>,<span class="number">80</span>),English=<span class="built_in">c</span>(<span class="number">86</span>,<span class="number">78</span>,<span class="number">65</span>,<span class="number">92</span>))</span><br><span class="line"><span class="built_in">anyNA</span>(x2)</span><br><span class="line">na.omit(x2)</span><br><span class="line">dates &lt;- <span class="built_in">c</span>(<span class="string">&quot;10/27/2017&quot;</span>, <span class="string">&quot;02/25/2017&quot;</span>, <span class="string">&quot;01/14/2017&quot;</span>, <span class="string">&quot;07/18/2017&quot;</span>, <span class="string">&quot;04/01/2017&quot;</span>)</span><br><span class="line"> <span class="comment"># 按照月日年的格式进行转换</span></span><br><span class="line">(date &lt;- as.Date(dates, <span class="string">&quot;%m/%d/%Y&quot;</span>))</span><br><span class="line">datas1&lt;- <span class="built_in">c</span>(<span class="string">&quot;2017-09-08 11:17:52&quot;</span>, <span class="string">&quot;2017-08-07 20:33:02&quot;</span>)</span><br><span class="line"><span class="comment"># 对字符串形式的日期时间值按照格式进行转换</span></span><br><span class="line">as.POSIXlt(datas1, tz = <span class="string">&quot;&quot;</span>, <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">(datas2 &lt;- strptime(datas1, <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)) </span><br><span class="line">score &lt;- data.frame(student = <span class="built_in">c</span>(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>), </span><br><span class="line">                    gender = <span class="built_in">c</span>(<span class="string">&quot;M&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;F&quot;</span>), </span><br><span class="line">                    math = <span class="built_in">c</span>(<span class="number">90</span>, <span class="number">70</span>, <span class="number">80</span>, <span class="number">60</span>), </span><br><span class="line">                    Eng = <span class="built_in">c</span>(<span class="number">88</span>, <span class="number">78</span>, <span class="number">69</span>, <span class="number">98</span>), </span><br><span class="line">                    p1 = <span class="built_in">c</span>(<span class="number">66</span>, <span class="number">59</span>, <span class="literal">NA</span>, <span class="number">88</span>))</span><br><span class="line"><span class="built_in">names</span>(score)[<span class="number">5</span>] = <span class="string">&quot;Chinese&quot;</span></span><br><span class="line">score</span><br><span class="line">sort(score$Chinese,decreasing=<span class="literal">TRUE</span>, na.last=<span class="literal">TRUE</span>) </span><br></pre></td></tr></table></figure>

<p>（3)构建一个数据框，并使用两种方法来选取变量；使用sample函数实现放回随机抽样与不放回随机抽样。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（3）</span></span><br><span class="line">data&lt;- data.frame(a = <span class="built_in">c</span>(<span class="number">5.1</span>, <span class="number">4.9</span>, <span class="number">4.7</span>), b = <span class="built_in">c</span>(<span class="number">3.5</span>, <span class="number">3.0</span>, <span class="number">3.2</span>), <span class="built_in">c</span> = <span class="built_in">c</span>( <span class="number">1.4</span>, <span class="number">1.3</span>, <span class="number">1.5</span>),d = <span class="built_in">rep</span>(<span class="number">0.2</span>, <span class="number">3</span>))</span><br><span class="line">newdata &lt;- data[, <span class="built_in">c</span>(<span class="number">3</span>:<span class="number">4</span>)]</span><br><span class="line">newdata1 &lt;- subset(data, a == <span class="string">&quot;4.9&quot;</span>, select = <span class="built_in">c</span>(b, d))</span><br><span class="line"></span><br><span class="line">a&lt;-<span class="built_in">c</span>(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">66</span>,<span class="number">77</span>,<span class="number">88</span>,<span class="number">99</span>)</span><br><span class="line">sample(a, <span class="number">5</span>, replace = <span class="literal">TRUE</span>) <span class="comment">#放回简单随机抽样</span></span><br><span class="line">sample(a, <span class="number">5</span>, replace = <span class="literal">FALSE</span>)  <span class="comment"># 不放回简单随机抽样</span></span><br></pre></td></tr></table></figure>

<p>（4)使用SQL语句对文中数据框stuscore进行计算。<br>①计算每个人的总成绩并排名（要求显示字段：学号、总成绩）。<br>②计算每个人单科的最高成绩（要求显示字段：学号、课程、最高成绩）。<br>③列出各门课程成绩最好的学生（要求显示字段：学号、科目、成绩）。<br>④列出各门课程成绩最差的学生（要求显示字段：学号、科目、成绩）。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（4）</span></span><br><span class="line">name &lt;- <span class="built_in">c</span>(<span class="built_in">rep</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">1</span>, <span class="number">3</span>), <span class="built_in">rep</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">3</span>))</span><br><span class="line">subject &lt;- <span class="built_in">c</span>(<span class="string">&quot;数学&quot;</span>, <span class="string">&quot;语文&quot;</span>, <span class="string">&quot;英语&quot;</span>, <span class="string">&quot;数学&quot;</span>, <span class="string">&quot;语文&quot;</span>, <span class="string">&quot;英语&quot;</span>)</span><br><span class="line">score &lt;- <span class="built_in">c</span>(<span class="number">89</span>, <span class="number">80</span>, <span class="number">70</span>, <span class="number">90</span>, <span class="number">70</span>, <span class="number">80</span>)</span><br><span class="line">stuid &lt;- <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">stuscore &lt;- data.frame(name, subject, score, stuid)</span><br><span class="line">library(sqldf)</span><br><span class="line"><span class="comment"># 计算每个人的总成绩并排名(要求显示字段：学号，总成绩)</span></span><br><span class="line">sqldf(<span class="string">&quot;select stuid, sum(score) as allscore from stuscore group by stuid order </span></span><br><span class="line"><span class="string">      by allscore&quot;</span>)</span><br><span class="line"><span class="comment"># 计算每个人单科的最高成绩(要求显示字段: 学号，课程，最高成绩)</span></span><br><span class="line">sqldf(<span class="string">&quot;select stuid, subject, max(score) as maxscore from stuscore group </span></span><br><span class="line"><span class="string">      by stuid&quot;</span>)</span><br><span class="line"><span class="comment"># 列出各门课程成绩最好的学生(要求显示字段: 学号,科目，成绩)</span></span><br><span class="line">sqldf(<span class="string">&quot;select stuid,  subject,max(score) as maxscore from stuscore group </span></span><br><span class="line"><span class="string">      by subject order by stuid&quot;</span>)</span><br><span class="line"><span class="comment"># 列出各门课程成绩最差的学生（要求显示字段：学号,科目，成绩）</span></span><br><span class="line">sqldf(<span class="string">&quot;select stuid,subject, min(score) as minscore from stuscore group by </span></span><br><span class="line"><span class="string">      subject order by stuid&quot;</span>)</span><br><span class="line">data&lt;-<span class="built_in">list</span>(a=<span class="built_in">c</span>(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>),b=matrix(<span class="number">1</span>:<span class="number">10</span>,nrow=<span class="number">2</span>),<span class="built_in">c</span>=<span class="string">&quot;one,two,three&quot;</span>,d=<span class="built_in">c</span>(<span class="literal">TRUE</span>,<span class="literal">FALSE</span>))</span><br><span class="line">data</span><br><span class="line">library(reshape2)</span><br><span class="line">melt(data, varnames = <span class="built_in">c</span>(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>), value.name = <span class="string">&quot;value&quot;</span>, na.rm = <span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure>
<p>*<del>（5)创建一个列表，并使用melt函数将其融合。</del> *<br>（6)构建一个字符型向量，并使用sub函数和 gsub 函数完成字符串替换；使用paste<br>两数分别返回一个字符型向量和一个字符串。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（5）</span></span><br><span class="line">data1&lt;-<span class="built_in">c</span>(<span class="string">&quot;we&quot;</span>,<span class="string">&quot;are&quot;</span>,<span class="string">&quot;family&quot;</span>,<span class="string">&quot;you&quot;</span>,<span class="string">&quot;good&quot;</span>)</span><br><span class="line">sub(<span class="string">&quot;eo&quot;</span>,<span class="string">&quot;t&quot;</span>,txt)</span><br><span class="line">gsub(<span class="string">&quot;eo&quot;</span>,<span class="string">&quot;t&quot;</span>,txt)</span><br><span class="line">b&lt;-paste(<span class="string">&quot;ab&quot;</span>, <span class="number">1</span>:<span class="number">3</span>, sep = <span class="string">&quot;&quot;</span>)  </span><br><span class="line">x &lt;- <span class="built_in">list</span>(a = <span class="string">&quot;st&quot;</span>, b = <span class="string">&quot;nd&quot;</span>, <span class="built_in">c</span> = <span class="string">&quot;yw&quot;</span>)</span><br><span class="line">y &lt;- <span class="built_in">list</span>(d = <span class="number">1</span>, e = <span class="number">2</span>)</span><br><span class="line"><span class="built_in">c</span>&lt;-paste(x, y, sep = <span class="string">&quot;-&quot;</span>, collapse = <span class="string">&quot;; &quot;</span>)  <span class="comment"># 设置collapse参数，连成一个字符串</span></span><br></pre></td></tr></table></figure>

<h1 id="第4章-函数与控制流"><a href="#第4章-函数与控制流" class="headerlink" title="第4章 函数与控制流"></a>第4章 函数与控制流</h1><h2 id="1-选择题-3"><a href="#1-选择题-3" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)下列能返回不小于x的最小整数的数学函数是（C）。<br>A.trunc<br>B.floor<br>C.ceiling<br>D.mad</p>
<p>（2)下列不属于apply函数使用对象的是（B）。<br>A.矩阵<br>B.向量<br>C.数组<br>D.数据框</p>
<p>（3)在ifelse(condition,statementl,statement2)语句中，当condition为TRUE时，执行的语句是（A）。<br>A.statementl<br>B.statement2<br>C.statement3<br>D.statement4</p>
<p>（4)在switch(expression,list)语句中，当list是有名定义、表达式等于变量名时，返回的结果是（B）。<br>A.列表相应位置的值<br>B.变量名对应的值<br>C.NULL”值<br>D.列表名</p>
<p>（5)下列不属于条件分支语句的数据分析的应用场景的是（B）。<br>A.if-else 语句<br>B.for循环语句<br>C.switch语句<br>D.ifelse语句</p>
<p>（6)下列关于cal(exprl,expr2….)函数表达不正确的是（A）。<br>A.exprl、expr2为需要输出的内容，必须为字符串<br>B.若exprl为“name”，则输出字符申“name<br>C.若exprl为变量name,则输出name的值<br>D.符号“ln”表示换行，表示“ln”后的语句在下一行输出</p>
<p>（7)能让while((i&lt;=10){expr}语句停止循环的选项是（B）。<br>A.i == 10<br>B.i == 11<br>C.i == 5<br>D.i == 1</p>
<p>（8)使用自定义函数时可通过（A）调用。<br>A.source 函数<br>B.var 函数<br>C.range函数<br>D.signif函数</p>
<p>（9)函数体不包括（C）部分。<br>A.异常处理<br>B.返回值<br>C.输入值<br>D.运算过程</p>
<p>（10)下列选项中表示返回值的函数是（D）。<br>A.median<br>B.dnorm<br>C.source<br>D.retum</p>
<h2 id="2-操作题-3"><a href="#2-操作题-3" class="headerlink" title="2.操作题"></a>2.操作题</h2><p>（1)使用apply函数族中的函数计算列表x&lt;-list(a=1:5,b=exp(0:3))中的各子列表的最大值、最小值与中位数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题(1)</span></span><br><span class="line">x &lt;- <span class="built_in">list</span>(a = <span class="number">1</span>:<span class="number">5</span>, b = <span class="built_in">exp</span>(<span class="number">0</span>:<span class="number">3</span>))</span><br><span class="line">lapply(x, <span class="built_in">max</span>)</span><br><span class="line">lapply(x, <span class="built_in">min</span>)</span><br><span class="line">lapply(x, median)</span><br></pre></td></tr></table></figure>

<p>（2)在区间［－5,5上绘制标准正态曲线，求位于z左侧的标准正态曲线下方的面积。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题(2)</span></span><br><span class="line"><span class="comment">#在区间[-5,5]上绘制标准正态曲线</span></span><br><span class="line">x &lt;- pretty(<span class="built_in">c</span>(-<span class="number">5</span>,<span class="number">5</span>), <span class="number">50</span>)</span><br><span class="line">y &lt;- dnorm(x)<span class="comment">##密度函数</span></span><br><span class="line">plot(x, y, type = <span class="string">&#x27;l&#x27;</span>, xlab = <span class="string">&#x27;Normal Deviate&#x27;</span>, ylab = <span class="string">&#x27;Density&#x27;</span>, yaxs = <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line"><span class="comment">#位于z=1.96左侧的标准正态曲线下方的面积</span></span><br><span class="line">pnorm(<span class="number">1.96</span>)</span><br></pre></td></tr></table></figure>

<p>（3)用条件分支语句将成绩划分为5个等级：A(大于等于90)、B(大于等于80)、（大于等于70)、D(大于等于60)、E(小于60).例如，对成绩87分进行判断。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（3）</span></span><br><span class="line">x &lt;- sample(<span class="number">0</span>:<span class="number">100</span>, <span class="number">1</span>)<span class="comment">#随机产生一个0-100的成绩</span></span><br><span class="line"><span class="keyword">if</span>(x&gt;=<span class="number">90</span>)&#123;</span><br><span class="line">  grade &lt;- <span class="string">&#x27;成绩等级：A&#x27;</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(x&gt;=<span class="number">80</span>)&#123;</span><br><span class="line">  grade &lt;- <span class="string">&#x27;成绩等级：B&#x27;</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(x&gt;=<span class="number">70</span>)&#123;</span><br><span class="line">  grade &lt;- <span class="string">&#x27;成绩等级：C&#x27;</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(x&gt;=<span class="number">60</span>)&#123;</span><br><span class="line">  grade &lt;- <span class="string">&#x27;成绩等级：D&#x27;</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  grade &lt;- <span class="string">&#x27;成绩等级：E&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">grade</span><br></pre></td></tr></table></figure>

<p>（4)判断101-200之间有多少个素数，并输出所有素数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（4）</span></span><br><span class="line">x &lt;- 101:<span class="number">200</span></span><br><span class="line">y &lt;- matrix(nrow = <span class="number">200</span>, ncol = <span class="number">100</span>)</span><br><span class="line">count &lt;- 0</span><br><span class="line">c &lt;- <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">100</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(j <span class="keyword">in</span> <span class="number">1</span>:<span class="number">200</span>)&#123;</span><br><span class="line">    y[j,i] &lt;- x[i] %% j</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">length</span>(which(y[,i]==<span class="number">0</span>))&lt;=<span class="number">2</span>)&#123;</span><br><span class="line">    count &lt;- count + <span class="number">1</span></span><br><span class="line">    <span class="built_in">c</span>[count] &lt;- i</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">count<span class="comment">#计数</span></span><br><span class="line">x[<span class="built_in">c</span>]<span class="comment">#所有素数</span></span><br></pre></td></tr></table></figure>

<p>（5)编写一个自定义函数求两个矩阵的乘积，并找出乘积矩阵中的最大元素。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（5）</span></span><br><span class="line">POM &lt;-<span class="keyword">function</span>(x,y)</span><br><span class="line">&#123;</span><br><span class="line">  maxer &lt;- <span class="keyword">function</span>(x.)</span><br><span class="line">  &#123;</span><br><span class="line">    print(<span class="built_in">max</span>(x.))</span><br><span class="line">  &#125;</span><br><span class="line">  m1 &lt;- ncol(x)</span><br><span class="line">  n &lt;- nrow(y)</span><br><span class="line">  <span class="keyword">if</span>(m1!=n)</span><br><span class="line">  &#123;</span><br><span class="line">    print(<span class="string">&#x27;error dimension is not siutable&#x27;</span>)</span><br><span class="line">    <span class="built_in">return</span>(<span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  m &lt;- nrow(x)</span><br><span class="line">  n1 &lt;- ncol(y)</span><br><span class="line">  s &lt;-matrix(<span class="number">0</span>,m,n1)</span><br><span class="line">  <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:m)</span><br><span class="line">    <span class="keyword">for</span>(j <span class="keyword">in</span> <span class="number">1</span>:n1)</span><br><span class="line">      s[i,j] &lt;- <span class="built_in">sum</span>(x[i,]*y[,j])</span><br><span class="line">  maxer(s)</span><br><span class="line">  <span class="built_in">return</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#矩阵s的行数等于矩阵x的行数，s的列数等于y的列数。</span></span><br><span class="line"><span class="comment">#乘积s的第m行第n列的元素等于矩阵x的第m行的元素与矩阵y的第n列对应元素乘积之和。</span></span><br><span class="line">x &lt;-matrix(<span class="built_in">c</span>(<span class="number">1</span>:<span class="number">6</span>),<span class="number">2</span>,<span class="number">3</span>,byrow = <span class="literal">TRUE</span>)<span class="comment">#按行</span></span><br><span class="line">y &lt;-matrix(<span class="built_in">c</span>(<span class="number">1</span>:<span class="number">6</span>),<span class="number">3</span>,<span class="number">2</span>,byrow = <span class="literal">FALSE</span>)<span class="comment">#按列</span></span><br><span class="line">POM(x,y)</span><br></pre></td></tr></table></figure>

<h1 id="第5章-初级绘图"><a href="#第5章-初级绘图" class="headerlink" title="第5章 初级绘图"></a>第5章 初级绘图</h1><h2 id="1-选择题-4"><a href="#1-选择题-4" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)下列可用于绘制散点图的是（A）。<br>A.plot函数<br>B.barplot函数<br>C.boxplot函数<br>D.hist函数</p>
<p>（2)下列图形中，不能分析数据分布情况的是（C）。<br>A.散点图<br>B.直方图<br>C.多变量相关矩阵图<br>D.箱线图</p>
<p>（3)数据维度较大时，为比较两两变量之间的相关关系，可以考虑绘制的图形是（D）。<br>A.散点图<br>B.箱线图<br>C.饼图<br>D.多变量相关矩阵图</p>
<p>（4)为展示数据类别的占比情况，可以考虑绘制的图形是（C）。<br>A.散点图<br>B.箱线图<br>D.多变量相关矩阵图<br>C.饼图</p>
<p>（5)下列绘制的图形与R函数对应关系不正确的是（B）。<br>A.散点图－plot函数<br>B.箱线图－barplot函数<br>C.QQ图－qqplot 函数<br>D.散点矩阵图－pairs函数</p>
<p>（6)下列选项中，（D）不是R自带的修改颜色函数。<br>A.ngb函数<br>B.colors 函数<br>C.palette 函数<br>D.brewer.pal函数</p>
<p>（7)能修改点样式的参数是（B）。<br>A.cex<br>B.pch<br>C.lwd<br>D.font</p>
<p>（8)可以在图形中的任意位置添加文字说明的函数是（B）。<br>A.title函数<br>B.text 函数<br>C.mtext函数<br>D.main函数</p>
<p>（9)为在现有图形上添加拟合直线，可以考虑的函数是（B）。<br>A.line函数<br>B.lines 函数<br>C.abline 函数<br>D.ablines函数</p>
<p>（10)下列图形参数与说明的对应关系不正确的是（D）。<br>A.axes-是否显示坐标轴<br>B.xlim-x轴的取值范围<br>C.col-颜色设置<br>D.font-是否显示标题</p>
<h2 id="2-操作题-4"><a href="#2-操作题-4" class="headerlink" title="2.操作题"></a>2.操作题</h2><p>（1)表5-23是某银行贷款拖欠率的数据bankloan.<br><strong>表5-23 银行贷款拖欠率的数据</strong><br>①比较有违约与无违约行为特征的人群分布。<br>②探索不同特征的人群收入与负债的分布情况。<br>③探索不同特征的人群收入与负债的关系。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（1）</span></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">bankloan &lt;- read.csv(<span class="string">&quot;F:/数据及程序/第4章/上机实验/data/bankloan.csv&quot;</span>) </span><br><span class="line">summary(bankloan)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据预处理，调整数据类型，将年龄、工龄分组</span></span><br><span class="line">bankloan$age_group &lt;- cut(bankloan$age, breaks = paste0(<span class="number">2</span>:<span class="number">6</span>, <span class="number">0</span>), include.lowest = <span class="literal">TRUE</span>)</span><br><span class="line">bankloan$seniority_group &lt;- cut(bankloan$seniority, </span><br><span class="line">                                breaks = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>), </span><br><span class="line">                                include.lowest = <span class="literal">TRUE</span>)</span><br><span class="line">bankloan$education &lt;- factor(bankloan$education)</span><br><span class="line">bankloan$debt &lt;- bankloan$debt_rate / <span class="number">100</span> * bankloan$income</span><br><span class="line">attach(bankloan)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制违约与不违约客户的年龄的条形图</span></span><br><span class="line">pal &lt;- RColorBrewer::brewer.pal(<span class="number">8</span>, <span class="string">&quot;Set1&quot;</span>)</span><br><span class="line">de_e &lt;- ftable(education, default)</span><br><span class="line">barplot(de_e, col = pal[<span class="number">1</span>:<span class="number">5</span>], beside = <span class="literal">TRUE</span>, xlab = <span class="string">&quot;default&quot;</span>)</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(education), pch = <span class="number">15</span>, col = pal, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">11</span>, <span class="number">270</span>, <span class="string">&quot;education:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制违约与不违约客户的教育的条形图</span></span><br><span class="line">de_a &lt;- ftable(age_group, default)</span><br><span class="line">barplot(de_a, col = pal[<span class="number">1</span>:<span class="number">4</span>], beside = <span class="literal">TRUE</span>, xlab = <span class="string">&quot;default&quot;</span>)</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(age_group), pch = <span class="number">15</span>, col = pal, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">8.8</span>, <span class="number">204</span>, <span class="string">&quot;age:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制违约与不违约客户的工龄的条形图</span></span><br><span class="line">de_s &lt;- ftable(seniority_group, default)</span><br><span class="line">barplot(de_s, col = pal[<span class="number">1</span>:<span class="number">8</span>], beside = <span class="literal">TRUE</span>, xlab = <span class="string">&quot;default&quot;</span>)</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(seniority_group), pch = <span class="number">15</span>, col = pal, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">15.3</span>, <span class="number">140</span>, <span class="string">&quot;seniority:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制违约与不违约客户的年龄、教育和工龄的Cleveland点图</span></span><br><span class="line">dotchart(de_e, bg = pal[<span class="number">1</span>:<span class="number">5</span>], labels = levels(education))</span><br><span class="line">dotchart(de_a, bg = pal[<span class="number">1</span>:<span class="number">4</span>], labels = levels(age_group))</span><br><span class="line">dotchart(de_s, bg = pal[<span class="number">1</span>:<span class="number">8</span>], labels = levels(seniority_group))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户收入的直方图</span></span><br><span class="line">set.seed(<span class="number">1234</span>)</span><br><span class="line">norm_income &lt;- rnorm(<span class="number">1000</span>, mean(income), sd(income))</span><br><span class="line">hist(income, freq = <span class="literal">FALSE</span>, breaks = <span class="number">50</span>)</span><br><span class="line">lines(density(income), col = <span class="number">2</span>)</span><br><span class="line">lines(density(norm_income), lty = <span class="number">2</span>, col = <span class="number">3</span>) </span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, <span class="built_in">c</span>(<span class="string">&quot;density&quot;</span>, <span class="string">&quot;normal&quot;</span>), lty = <span class="number">1</span>:<span class="number">2</span>, col = <span class="number">2</span>:<span class="number">3</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户负债的直方图</span></span><br><span class="line">norm_debt &lt;- rnorm(<span class="number">1000</span>, mean(debt), sd(debt))</span><br><span class="line">hist(debt, freq = <span class="literal">FALSE</span>, breaks = <span class="number">50</span>)</span><br><span class="line">lines(density(debt), col = <span class="number">2</span>)</span><br><span class="line">lines(density(norm_debt), lty = <span class="number">2</span>, col = <span class="number">3</span>) </span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, <span class="built_in">c</span>(<span class="string">&quot;density&quot;</span>, <span class="string">&quot;normal&quot;</span>), lty = <span class="number">1</span>:<span class="number">2</span>, col = <span class="number">2</span>:<span class="number">3</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户收入的核密度图</span></span><br><span class="line">library(sm)</span><br><span class="line">sm.density.compare(income, factor(education))</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(education), lty = <span class="number">1</span>:<span class="number">5</span>, col = <span class="number">2</span>:<span class="number">6</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">450</span>, <span class="number">0.015</span>, <span class="string">&quot;education:&quot;</span>)</span><br><span class="line"></span><br><span class="line">sm.density.compare(income, factor(age_group))</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(age_group), lty = <span class="number">1</span>:<span class="number">4</span>, col = <span class="number">2</span>:<span class="number">5</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">430</span>, <span class="number">0.026</span>, <span class="string">&quot;age:&quot;</span>)</span><br><span class="line"></span><br><span class="line">sm.density.compare(income, factor(seniority_group))</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(seniority_group), lty = <span class="number">1</span>:<span class="number">8</span>, col = <span class="number">2</span>:<span class="number">9</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">425</span>, <span class="number">0.03</span>, <span class="string">&quot;seniority:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户负债的核密度图</span></span><br><span class="line">sm.density.compare(debt, factor(education))</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(education), lty = <span class="number">1</span>:<span class="number">5</span>, col = <span class="number">2</span>:<span class="number">6</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">40</span>, <span class="number">0.125</span>, <span class="string">&quot;education:&quot;</span>)</span><br><span class="line"></span><br><span class="line">sm.density.compare(debt, factor(age_group))</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(age_group), lty = <span class="number">1</span>:<span class="number">4</span>, col = <span class="number">2</span>:<span class="number">5</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">38</span>, <span class="number">0.16</span>, <span class="string">&quot;age:&quot;</span>)</span><br><span class="line"></span><br><span class="line">sm.density.compare(debt, factor(seniority_group))</span><br><span class="line">legend(<span class="string">&quot;topright&quot;</span>, levels(seniority_group), lty = <span class="number">1</span>:<span class="number">8</span>, col = <span class="number">2</span>:<span class="number">9</span>, bty = <span class="string">&quot;n&quot;</span>)</span><br><span class="line">text(<span class="number">37</span>, <span class="number">0.16</span>, <span class="string">&quot;seniority:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户收入的箱线图</span></span><br><span class="line">boxplot(income ~ education, horizontal = <span class="literal">TRUE</span>)</span><br><span class="line">boxplot(income ~ age_group, horizontal = <span class="literal">TRUE</span>)</span><br><span class="line">boxplot(income ~ seniority_group, horizontal = <span class="literal">TRUE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户负债的箱线图</span></span><br><span class="line">boxplot(debt ~ education, horizontal = <span class="literal">TRUE</span>)</span><br><span class="line">boxplot(debt ~ age_group, horizontal = <span class="literal">TRUE</span>)</span><br><span class="line">boxplot(debt ~ seniority_group, horizontal = <span class="literal">TRUE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据客户的年龄、教育和工龄对客户收入分组</span></span><br><span class="line">income_e &lt;- tapply(income, education, <span class="keyword">function</span> (t) t)</span><br><span class="line">income_a &lt;- tapply(income, age_group, <span class="keyword">function</span> (t) t)</span><br><span class="line">income_s &lt;- tapply(income, seniority_group, <span class="keyword">function</span> (t) t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制不同年龄、教育和工龄的客户收入的小提琴图</span></span><br><span class="line">library(vioplot)</span><br><span class="line">vioplot(income_e$`<span class="number">1</span>`, income_e$`2`, income_e$`3`, income_e$`4`, income_e$`5`, </span><br><span class="line">        names = levels(education), border = &quot;black&quot;, col = &quot;light green&quot;, rectCol = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line">vioplot(income_a$`[<span class="number">20</span>,<span class="number">30</span>]`, income_a$`(<span class="number">30</span>,<span class="number">40</span>]`, income_a$`(<span class="number">40</span>,<span class="number">50</span>]`, </span><br><span class="line">        income_a$`(<span class="number">50</span>,<span class="number">60</span>]`, names = levels(age_group), border = &quot;black&quot;, </span><br><span class="line">        col = &quot;light green&quot;, rectCol = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line">vioplot(income_s$`[<span class="number">0</span>,<span class="number">1</span>]`, income_s$`(<span class="number">1</span>,<span class="number">3</span>]`, income_s$`(<span class="number">3</span>,<span class="number">5</span>]`, </span><br><span class="line">        income_s$`(<span class="number">5</span>,<span class="number">10</span>]`, income_s$`(<span class="number">10</span>,<span class="number">15</span>]`, income_s$`(<span class="number">15</span>,<span class="number">20</span>]`, </span><br><span class="line">        income_s$`(<span class="number">20</span>,<span class="number">30</span>]`, income_s$`(<span class="number">30</span>,<span class="number">40</span>]`, names = levels(seniority_group), </span><br><span class="line">        border = &quot;black&quot;, col = &quot;light green&quot;, rectCol = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line"># 根据客户的年龄、教育和工龄对客户负债分组</span><br><span class="line">debt_e &lt;- tapply(debt, education, function (t) t)</span><br><span class="line">debt_a &lt;- tapply(debt, age_group, function (t) t)</span><br><span class="line">debt_s &lt;- tapply(debt, seniority_group, function (t) t)</span><br><span class="line"></span><br><span class="line"># 绘制不同年龄、教育和工龄的客户负债的小提琴图</span><br><span class="line">vioplot(debt_e$`1`, debt_e$`2`, debt_e$`3`, debt_e$`4`, debt_e$`5`, </span><br><span class="line">        names = levels(education), border = &quot;black&quot;, col = &quot;light green&quot;, rectCol = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line">vioplot(debt_a$`[<span class="number">20</span>, <span class="number">30</span>]`, debt_a$`(<span class="number">30</span>, <span class="number">40</span>]`, debt_a$`(<span class="number">40</span>, <span class="number">50</span>]`, debt_a$`(<span class="number">50</span>, <span class="number">60</span>]`, </span><br><span class="line">        names = levels(age_group), border = &quot;black&quot;, col = &quot;light green&quot;, rectCol = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line">vioplot(debt_s$`[<span class="number">0</span>,<span class="number">1</span>]`, debt_s$`(<span class="number">1</span>,<span class="number">3</span>]`, debt_s$`(<span class="number">3</span>,<span class="number">5</span>]`, debt_s$`(<span class="number">5</span>,<span class="number">10</span>]`, </span><br><span class="line">        debt_s$`(<span class="number">10</span>,<span class="number">15</span>]`, debt_s$`(<span class="number">15</span>,<span class="number">20</span>]`, debt_s$`(<span class="number">20</span>,<span class="number">30</span>]`, debt_s$`(<span class="number">30</span>,<span class="number">40</span>]`, </span><br><span class="line">        names = levels(seniority_group), border = &quot;black&quot;, col = &quot;light green&quot;, rectCol = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 绘制不同年龄、教育和工龄下客户的收入与负债的散点图</span><br><span class="line">le &lt;- levels(education)</span><br><span class="line">op &lt;- par(mfrow = c(1, 5))</span><br><span class="line">for (i in 1:nlevels(education)) &#123;</span><br><span class="line">  plot(income[education == le[i]], debt[education == le[i]], </span><br><span class="line">       main = paste(&quot;education = &quot;, le[i]), xlab = &quot;income&quot;, ylab = &quot;debt&quot;)</span><br><span class="line">  abline(lm(debt[education == le[i]] ~ income[education == le[i]]), col = &quot;red&quot;)</span><br><span class="line">&#125;</span><br><span class="line">par(op)</span><br><span class="line"></span><br><span class="line">la &lt;- levels(age_group)</span><br><span class="line">op &lt;- par(mfrow = c(1, 4))</span><br><span class="line">for (i in 1:nlevels(age_group)) &#123;</span><br><span class="line">  plot(income[age_group == la[i]], debt[age_group == la[i]], </span><br><span class="line">       main = paste(&quot;age_group = &quot;, la[i]), xlab = &quot;income&quot;, ylab = &quot;debt&quot;)</span><br><span class="line">  abline(lm(debt[age_group == la[i]] ~ income[age_group == la[i]]), col = &quot;red&quot;)</span><br><span class="line">&#125;</span><br><span class="line">par(op)</span><br><span class="line"></span><br><span class="line">ls &lt;- levels(seniority_group)</span><br><span class="line">op &lt;- par(mfrow,c(1, 4))</span><br><span class="line">for(i in 1:nlevels(seniority_group))&#123;</span><br><span class="line">  plot(income[seniority_group == ls[i]], debt[seniority_group == ls[i]], </span><br><span class="line">       main = paste(&quot;seniority_group = &quot;, ls[i]), xlab = &quot;income&quot;, ylab = &quot;debt&quot;)</span><br><span class="line">  abline(lm(debt[seniority_group == ls[i]] ~ income[seniority_group == ls[i]]), col = &quot;red&quot;)</span><br><span class="line">&#125;</span><br><span class="line">par(op)</span><br></pre></td></tr></table></figure>

<p>（2)根据VADeaths数据集，分别绘制城镇居民与农村居民死亡情况的饼图，添加标题及图例说明，并分析图表。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（2）</span></span><br><span class="line">my_sum &lt;- colSums(VADeaths)</span><br><span class="line">Rural &lt;- <span class="built_in">sum</span>(my_sum[grep(<span class="string">&#x27;Rural&#x27;</span>, <span class="built_in">names</span>(my_sum))])  <span class="comment"># 农村居民数据</span></span><br><span class="line">Urban &lt;- <span class="built_in">sum</span>(my_sum[grep(<span class="string">&#x27;Urban&#x27;</span>, <span class="built_in">names</span>(my_sum))])  <span class="comment"># 城镇居民数据</span></span><br><span class="line">pie(<span class="built_in">c</span>(Rural, Urban), labels = <span class="built_in">c</span>(<span class="string">&#x27;Rural&#x27;</span>, <span class="string">&#x27;Urban&#x27;</span>), col = <span class="built_in">c</span>(<span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>))</span><br><span class="line">title(<span class="string">&#x27;城镇居民与农村居民死亡情况&#x27;</span>)</span><br><span class="line">legend(<span class="string">&#x27;topleft&#x27;</span>, legend = <span class="built_in">c</span>(<span class="string">&#x27;Rural&#x27;</span>, <span class="string">&#x27;Urban&#x27;</span>), fill = <span class="built_in">c</span>(<span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>（3)在同一画布上绘制iris数据集的4个属性两两之间的散点图，所得到的结果如图5-36所示。<br><strong>图5-36 属性两两之间的散点图</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（3）</span></span><br><span class="line">path = paste0(<span class="string">&#x27;VADeaths&#x27;</span>, <span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">png(filename = path)</span><br><span class="line">pie(<span class="built_in">c</span>(Rural, Urban), labels = <span class="built_in">c</span>(<span class="string">&#x27;Rural&#x27;</span>, <span class="string">&#x27;Urban&#x27;</span>), col = <span class="built_in">c</span>(<span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>))</span><br><span class="line">title(<span class="string">&#x27;城镇居民与农村居民死亡情况&#x27;</span>)</span><br><span class="line">legend(<span class="string">&#x27;topleft&#x27;</span>, legend = <span class="built_in">c</span>(<span class="string">&#x27;Rural&#x27;</span>, <span class="string">&#x27;Urban&#x27;</span>), fill = <span class="built_in">c</span>(<span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>))</span><br><span class="line">dev.off()</span><br></pre></td></tr></table></figure>

<p>（4)将第（3)题的结果保存为PNG文件格式，并储存到当前工作目录下。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（4）</span></span><br><span class="line">path = paste(<span class="string">&#x27;ex5_4&#x27;</span>,<span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line">jpeg(file = path)</span><br><span class="line">par(mfrow = <span class="built_in">c</span>(<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">name &lt;- colnames(iris)[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (j <span class="keyword">in</span> (i+<span class="number">1</span>):<span class="number">4</span>) &#123;</span><br><span class="line">    plot(iris[, i], iris[, j], xlab = name[i], ylab = name[j])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">dev.off()</span><br></pre></td></tr></table></figure>

<h1 id="第6章-高级绘图"><a href="#第6章-高级绘图" class="headerlink" title="第6章 高级绘图"></a>第6章 高级绘图</h1><h2 id="1-选择题-5"><a href="#1-选择题-5" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)下列不能作为lattice包中的绘图函数 formula输人的是（B）。<br>A.x<del>y<br>B.</del>y<br>C.x<del>y|A<br>D.x</del>y|A-B</p>
<p>（2)下列绘图函数不属于lattice包的是（C）。<br>A.xyplot<br>B.qq<br>C.qqplot<br>D.qqmath</p>
<p>（3)lattice包中可实现图形组合的是（C）。<br>A.par函数<br>B.layout 函数<br>C.split参数<br>D.newpage参数</p>
<p>（4)下列绘图函数与图形对应关系错误的是（A）。<br>A.histogram-散点图<br>B.barchar-条形图<br>C.bwplot-箱线图<br>D.splom－散点矩阵图</p>
<p>（5)lattice包中的绘图函数的条件变量不能输入（A）。<br>A.连续型变量<br>B.离散型变量<br>C.因子型数据<br>D.字符型数据</p>
<p>（6)一个图层不包含（D）。<br>A.data<br>B.aes<br>C.mapping<br>D.geom</p>
<p>（7)下列选项中不能描述坐标系转换关系的是（C）。<br>A.饼图＝堆叠长条图＋polar coordinates<br>B.靶心图＝饼图＋polar coordinates<br>C.锯齿图＝饼图＋polar coordinates<br>D.锯齿图＝柱状图＋polar coordinates</p>
<p>（8)ggplot包中实现分面的函数是（D）。<br>A.par函数<br>B.layout 函数<br>C.split参数<br>D.facet grid函数</p>
<p>（9)下列选项不能描述绘图函数与图形对应关系的是（B）。<br>A.geom abline-线<br>B.geom_histogram-条形图<br>C.geom_boxplot-箱线图<br>D.geom_point-点</p>
<p>（10)下列不属于图形属性的是（D）。<br>A.alpha<br>B.color<br>C.linetype<br>D.ncol</p>
<h2 id="2-操作题-5"><a href="#2-操作题-5" class="headerlink" title="2.操作题"></a>2.操作题</h2><p>（1)表6-7所示是某银行的贷款拖欠率的数据 bankloan.要求使用lattice 包完成以下图形的绘制。<br>①绘制不同年龄、受教育程度和工龄的客户的收入与负债的直方图及密度分布曲线。<br>②绘制不同年龄、受教育程度和工龄的客户的收入与负债的散点图，并添加回归线。<br>③绘制不同年龄、受教育程度和工龄的客户违约与否的条形图。<br>④绘制客户的收人和负债与违约与否的散点图，非添加logistic回归线。<br><strong>表6-7银行贷款拖欠率数据</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（1）</span></span><br><span class="line">bankloan = read.csv(<span class="string">&quot;./第6章 高级绘图/02-习题程序/code/data/bankloan.csv&quot;</span>) </span><br><span class="line">summary(bankloan)</span><br><span class="line"><span class="comment"># 数据预处理</span></span><br><span class="line">bankloan$age_group &lt;- cut(bankloan$age, breaks = paste0(<span class="number">2</span>:<span class="number">6</span>, <span class="number">0</span>), include.lowest = <span class="literal">TRUE</span>)</span><br><span class="line">bankloan$seniority_group &lt;- cut(bankloan$seniority, </span><br><span class="line">                                breaks = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>), </span><br><span class="line">                                include.lowest = <span class="literal">TRUE</span>)</span><br><span class="line">bankloan$education &lt;- factor(bankloan$education)</span><br><span class="line">bankloan$debt &lt;- bankloan$debt_rate / <span class="number">100</span> * bankloan$income</span><br><span class="line"></span><br><span class="line"><span class="comment"># lattice</span></span><br><span class="line">library(lattice)</span><br><span class="line"><span class="comment"># histogram of income</span></span><br><span class="line"><span class="comment"># education</span></span><br><span class="line">histogram_ie &lt;- histogram( ~ income|education, data = bankloan, </span><br><span class="line">                           layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">5</span>), nint = <span class="number">30</span>, type = <span class="string">&quot;count&quot;</span>)</span><br><span class="line">densityplot_ie &lt;- densityplot( ~ income, groups = education, data = bankloan, plot.points = <span class="literal">FALSE</span>, </span><br><span class="line">                               lty = <span class="number">1</span>:<span class="number">5</span>, col = <span class="number">1</span>:<span class="number">5</span>, key = <span class="built_in">list</span>(title = <span class="string">&quot;education&quot;</span>, </span><br><span class="line">                                                                text = <span class="built_in">list</span>(levels(bankloan$education)), </span><br><span class="line">                                                                column = <span class="number">2</span>, lines = <span class="built_in">list</span>(lty = <span class="number">1</span>:<span class="number">5</span>, col = <span class="number">1</span>:<span class="number">5</span>)))</span><br><span class="line">plot(histogram_ie, position = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>))  </span><br><span class="line">plot(densityplot_ie, position = <span class="built_in">c</span>(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"><span class="comment"># age</span></span><br><span class="line">histogram_ia &lt;- histogram( ~ income|age_group, data = bankloan, layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">4</span>), nint = <span class="number">30</span>, type = <span class="string">&quot;count&quot;</span>)</span><br><span class="line">densityplot_ia &lt;- densityplot( ~ income, groups = age_group, data = bankloan, plot.points = <span class="literal">FALSE</span>, </span><br><span class="line">                               lty = <span class="number">1</span>:<span class="number">4</span>, col = <span class="number">1</span>:<span class="number">4</span>, key = <span class="built_in">list</span>(title = <span class="string">&quot;age&quot;</span>, text = <span class="built_in">list</span>(levels(bankloan$age_group)), </span><br><span class="line">                                                                column = <span class="number">2</span>, lines = <span class="built_in">list</span>(lty = <span class="number">1</span>:<span class="number">4</span>, col = <span class="number">1</span>:<span class="number">4</span>)))</span><br><span class="line">plot(histogram_ia, position = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>))  </span><br><span class="line">plot(densityplot_ia, position = <span class="built_in">c</span>(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># seniority</span></span><br><span class="line">histogram_is &lt;- histogram( ~ income|seniority_group, data = bankloan, </span><br><span class="line">                           layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">8</span>), nint = <span class="number">30</span>, type = <span class="string">&quot;count&quot;</span>)</span><br><span class="line">densityplot_is &lt;- densityplot( ~ income, groups = seniority_group, data = bankloan, plot.points = <span class="literal">FALSE</span>, </span><br><span class="line">                               lty = <span class="number">1</span>:<span class="number">8</span>, col = <span class="number">1</span>:<span class="number">8</span>, key = <span class="built_in">list</span>(title = <span class="string">&quot;seniority&quot;</span>, </span><br><span class="line">                                                                text = <span class="built_in">list</span>(levels(bankloan$seniority_group)), </span><br><span class="line">                                                                column = <span class="number">2</span>, lines = <span class="built_in">list</span>(lty = <span class="number">1</span>:<span class="number">8</span>, col = <span class="number">1</span>:<span class="number">8</span>)))</span><br><span class="line">plot(histogram_is, position = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>))  </span><br><span class="line">plot(densityplot_is, position = <span class="built_in">c</span>(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># histogram of debt</span></span><br><span class="line"><span class="comment"># education</span></span><br><span class="line">histogram_de &lt;- histogram( ~ debt_rate|education, data = bankloan, layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">5</span>), nint = <span class="number">30</span>, type = <span class="string">&quot;count&quot;</span>)</span><br><span class="line">densityplot_de &lt;- densityplot( ~ debt_rate, groups = education, data = bankloan, plot.points = <span class="literal">FALSE</span>, </span><br><span class="line">                               lty = <span class="number">1</span>:<span class="number">5</span>, col = <span class="number">1</span>:<span class="number">5</span>, key = <span class="built_in">list</span>(title = <span class="string">&quot;education&quot;</span>, </span><br><span class="line">                                                                text = <span class="built_in">list</span>(levels(bankloan$education)), </span><br><span class="line">                                                                column = <span class="number">2</span>, lines = <span class="built_in">list</span>(lty = <span class="number">1</span>:<span class="number">5</span>, col = <span class="number">1</span>:<span class="number">5</span>)))</span><br><span class="line">plot(histogram_de, position = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>))  </span><br><span class="line">plot(densityplot_de, position = <span class="built_in">c</span>(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"><span class="comment"># age</span></span><br><span class="line">histogram_da &lt;- histogram( ~ debt_rate|age_group, data = bankloan, </span><br><span class="line">                           layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">4</span>), nint = <span class="number">30</span>, type = <span class="string">&quot;count&quot;</span>)</span><br><span class="line">densityplot_da &lt;- densityplot( ~ debt_rate, groups = age_group, data = bankloan, </span><br><span class="line">                               plot.points = <span class="literal">FALSE</span>, </span><br><span class="line">                               lty = <span class="number">1</span>:<span class="number">4</span>, col = <span class="number">1</span>:<span class="number">4</span>, </span><br><span class="line">                               key = <span class="built_in">list</span>(title = <span class="string">&quot;age&quot;</span>, text = <span class="built_in">list</span>(levels(bankloan$age_group)), </span><br><span class="line">                                          column = <span class="number">2</span>, lines = <span class="built_in">list</span>(lty = <span class="number">1</span>:<span class="number">4</span>, col = <span class="number">1</span>:<span class="number">4</span>)))</span><br><span class="line">plot(histogram_da, position = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>))  </span><br><span class="line">plot(densityplot_da, position = <span class="built_in">c</span>(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># seniority</span></span><br><span class="line">histogram_ds &lt;- histogram( ~ debt_rate|seniority_group, data = bankloan, </span><br><span class="line">                           layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">8</span>), nint = <span class="number">30</span>, type = <span class="string">&quot;count&quot;</span>)</span><br><span class="line">densityplot_ds &lt;- densityplot( ~ debt_rate, groups = seniority_group, data = bankloan, plot.points = <span class="literal">FALSE</span>, </span><br><span class="line">                               lty = <span class="number">1</span>:<span class="number">8</span>, col = <span class="number">1</span>:<span class="number">8</span>, key = <span class="built_in">list</span>(title = <span class="string">&quot;seniority&quot;</span>, </span><br><span class="line">                                                                text = <span class="built_in">list</span>(levels(bankloan$seniority_group)), </span><br><span class="line">                                                                column = <span class="number">2</span>, lines = <span class="built_in">list</span>(lty = <span class="number">1</span>:<span class="number">8</span>, col = <span class="number">1</span>:<span class="number">8</span>)))</span><br><span class="line">plot(histogram_ds, position = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>))  </span><br><span class="line">plot(densityplot_ds, position = <span class="built_in">c</span>(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"><span class="comment"># income vs debt</span></span><br><span class="line">id_e &lt;- xyplot(debt ~ income|education, data = bankloan, layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">5</span>), </span><br><span class="line">               panel = <span class="keyword">function</span>(...)&#123;panel.lmline(...)</span><br><span class="line">                 panel.xyplot(...)&#125;)</span><br><span class="line">id_a &lt;- xyplot(debt ~ income|age_group, data = bankloan, layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">4</span>), </span><br><span class="line">               panel = <span class="keyword">function</span>(...)&#123;panel.lmline(...)</span><br><span class="line">                 panel.xyplot(...)&#125;)</span><br><span class="line">id_s &lt;- xyplot(debt ~ income|seniority_group, data = bankloan, layout = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">8</span>), </span><br><span class="line">               panel = <span class="keyword">function</span>(...)&#123;panel.lmline(...)</span><br><span class="line">                 panel.xyplot(...)&#125;)</span><br><span class="line">plot(id_e, split = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>))  </span><br><span class="line">plot(id_a, split = <span class="built_in">c</span>(<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line">plot(id_s, split = <span class="built_in">c</span>(<span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># default vs income or debt_rate</span></span><br><span class="line"><span class="comment"># lattice</span></span><br><span class="line">glmdei &lt;- as.vector(glm(default ~ income, data = bankloan, </span><br><span class="line">                        family = binomial(link = <span class="string">&quot;logit&quot;</span>))$coefficients)</span><br><span class="line">glmded &lt;- as.vector(glm(default ~ debt_rate, data = bankloan, </span><br><span class="line">                        family = binomial(link = <span class="string">&quot;logit&quot;</span>))$coefficients)</span><br><span class="line"></span><br><span class="line">paneli &lt;- <span class="keyword">function</span> (x, y) &#123;</span><br><span class="line">  panel.curve(<span class="built_in">exp</span>(glmdei[<span class="number">1</span>] + glmdei[<span class="number">2</span>] * x) / (<span class="number">1</span> + <span class="built_in">exp</span>(glmdei[<span class="number">1</span>] + glmdei[<span class="number">2</span>] * x)), </span><br><span class="line">              col = <span class="string">&quot;red&quot;</span>, lwd = <span class="number">1</span>, lty = <span class="number">2</span>)</span><br><span class="line">  panel.xyplot(x, y)</span><br><span class="line">&#125;</span><br><span class="line">paneld &lt;- <span class="keyword">function</span> (x, y) &#123;</span><br><span class="line">  panel.curve(<span class="built_in">exp</span>(glmded[<span class="number">1</span>] + glmded[<span class="number">2</span>] * x) / (<span class="number">1</span> + <span class="built_in">exp</span>(glmded[<span class="number">1</span>] + glmded[<span class="number">2</span>] * x)), </span><br><span class="line">              col = <span class="string">&quot;red&quot;</span>, lwd = <span class="number">1</span>, lty = <span class="number">2</span>)</span><br><span class="line">  panel.xyplot(x, y)</span><br><span class="line">&#125;</span><br><span class="line">glmla_dei &lt;- xyplot(default ~ income, data = bankloan, panel = paneli)</span><br><span class="line">glmla_ded &lt;- xyplot(default ~ income, data = bankloan, panel = paneld)</span><br><span class="line">plot(glmla_dei, split = <span class="built_in">c</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>))  </span><br><span class="line">plot(glmla_ded, split = <span class="built_in">c</span>(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>), newpage = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># bar of default</span></span><br><span class="line"><span class="comment"># lattice</span></span><br><span class="line">tbankloan &lt;- table(bankloan$education, bankloan$seniority_group, bankloan$age_group, bankloan$default)</span><br><span class="line">barchart(tbankloan, auto.key = <span class="built_in">list</span>(title = <span class="string">&quot;default&quot;</span>, columns = <span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<p>（2)针对（1)中提及的bankloan的示例表，使用ggplo12包完成以下图形的绘制。<br>①绘制不同年龄、受教育程度和工龄的客户的收入与负债的直方图和密度分布曲线。<br>②绘制不同年龄、受教育程度和工龄的客户的收人与负债的散点图，并添加回归线。<br>③绘制不同年龄、受教育程度和工龄的客户违约与否的条形图。<br>④绘制客户的收人和负债与违约与否的散点图，并添加logistic回归线。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#操作题（2）</span></span><br><span class="line">bankloan = read.csv(<span class="string">&quot;./第6章 高级绘图/02-习题程序/code/data/bankloan.csv&quot;</span>) </span><br><span class="line">summary(bankloan)</span><br><span class="line"><span class="comment"># 数据预处理</span></span><br><span class="line">bankloan$age_group &lt;- cut(bankloan$age, breaks = paste0(<span class="number">2</span>:<span class="number">6</span>, <span class="number">0</span>), include.lowest = <span class="literal">TRUE</span>)</span><br><span class="line">bankloan$seniority_group &lt;- cut(bankloan$seniority, </span><br><span class="line">                                breaks = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>), </span><br><span class="line">                                include.lowest = <span class="literal">TRUE</span>)</span><br><span class="line">bankloan$education &lt;- factor(bankloan$education)</span><br><span class="line">bankloan$debt &lt;- bankloan$debt_rate / <span class="number">100</span> * bankloan$income</span><br><span class="line"><span class="comment"># ggplot2</span></span><br><span class="line">library(ggplot2)</span><br><span class="line">library(grid)</span><br><span class="line">page &lt;- <span class="keyword">function</span> (x, y) viewport(layout.pos.row = x, layout.pos.col = y)</span><br><span class="line"><span class="comment"># histogram of income</span></span><br><span class="line"><span class="comment"># education</span></span><br><span class="line">hist_ie &lt;- ggplot(data = bankloan, aes(x = income)) + </span><br><span class="line">  geom_histogram(bins = <span class="number">30</span>, fill = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  facet_grid(education ~ .)</span><br><span class="line">density_ie &lt;- ggplot(data = bankloan, aes(x = income, colour = education)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  theme(legend.position = <span class="string">&quot;top&quot;</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(hist_ie, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(density_ie, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># age</span></span><br><span class="line">hist_ia &lt;- ggplot(data = bankloan, aes(x = income)) + </span><br><span class="line">  geom_histogram(bins = <span class="number">30</span>, fill = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  facet_grid(age_group ~ .)</span><br><span class="line">density_ia &lt;- ggplot(data = bankloan, aes(x = income, colour = age_group)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  theme(legend.position = <span class="string">&quot;top&quot;</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(hist_ia, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(density_ia, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># seniority</span></span><br><span class="line">hist_is &lt;- ggplot(data = bankloan, aes(x = income)) + </span><br><span class="line">  geom_histogram(bins = <span class="number">30</span>, fill = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  facet_grid(seniority_group ~ .)</span><br><span class="line">density_is &lt;- ggplot(data = bankloan, aes(x = income, colour = seniority_group)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  theme(legend.position = <span class="string">&quot;top&quot;</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(hist_is, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(density_is, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># histogram of debt</span></span><br><span class="line"><span class="comment"># education</span></span><br><span class="line">hist_de &lt;- ggplot(data = bankloan, aes(x = debt_rate)) + </span><br><span class="line">  geom_histogram(bins = <span class="number">30</span>, fill = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  facet_grid(education ~ .)</span><br><span class="line">density_de &lt;- ggplot(data = bankloan, aes(x = debt_rate, colour = education)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  theme(legend.position = <span class="string">&quot;top&quot;</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(hist_de, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(density_de, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># age</span></span><br><span class="line">hist_da &lt;- ggplot(data = bankloan, aes(x = debt_rate)) + </span><br><span class="line">  geom_histogram(bins = <span class="number">30</span>, fill = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  facet_grid(age_group ~ .)</span><br><span class="line">density_da &lt;- ggplot(data = bankloan, aes(x = debt_rate, colour = age_group)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  theme(legend.position = <span class="string">&quot;top&quot;</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(hist_da, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(density_da, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># seniority</span></span><br><span class="line">hist_ds &lt;- ggplot(data = bankloan, aes(x = debt_rate)) + </span><br><span class="line">  geom_histogram(bins = <span class="number">30</span>, fill = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  facet_grid(seniority_group ~ .)</span><br><span class="line">density_ds &lt;- ggplot(data = bankloan, aes(x = debt_rate, colour = seniority_group)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  theme(legend.position = <span class="string">&quot;top&quot;</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(hist_ds, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(density_ds, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># income vs debt</span></span><br><span class="line">ggid_e &lt;- ggplot(data = bankloan, aes(x = income, y = debt)) + </span><br><span class="line">  geom_point(colour = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  stat_smooth(method = lm, lwd = <span class="number">0.5</span>, se = <span class="literal">FALSE</span>) + </span><br><span class="line">  facet_grid(education ~ .)</span><br><span class="line">ggid_a &lt;- ggplot(data = bankloan, aes(x = income, y = debt)) + </span><br><span class="line">  geom_point(colour = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  stat_smooth(method = lm, lwd = <span class="number">0.5</span>, se = <span class="literal">FALSE</span>) + </span><br><span class="line">  facet_grid(age_group ~ .)</span><br><span class="line">ggid_s &lt;- ggplot(data = bankloan, aes(x = income, y = debt)) + </span><br><span class="line">  geom_point(colour = <span class="string">&quot;#0080ff&quot;</span>) + </span><br><span class="line">  stat_smooth(method = lm, lwd = <span class="number">0.5</span>, se = <span class="literal">FALSE</span>) + </span><br><span class="line">  facet_grid(seniority_group ~ .)</span><br><span class="line"></span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">3</span>)))</span><br><span class="line">print(ggid_e, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(ggid_a, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">print(ggid_s, vp = page(<span class="number">1</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># default vs income or debt_rate</span></span><br><span class="line"><span class="comment"># ggplot2</span></span><br><span class="line">glmgg_dei &lt;- ggplot(data = bankloan, aes(x = income, y = default))  + </span><br><span class="line">  geom_point()  +  </span><br><span class="line">  stat_smooth(method = glm, method.args = <span class="built_in">list</span>(family = <span class="string">&quot;binomial&quot;</span>), se = <span class="literal">FALSE</span>)</span><br><span class="line">glmgg_ded &lt;- ggplot(data = bankloan, aes(x = debt_rate, y = default))  + </span><br><span class="line">  geom_point()  +  </span><br><span class="line">  stat_smooth(method = glm, method.args = <span class="built_in">list</span>(family = <span class="string">&quot;binomial&quot;</span>), se = <span class="literal">FALSE</span>)</span><br><span class="line">grid.newpage()</span><br><span class="line">pushViewport(viewport(layout = grid.layout(<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(glmgg_dei, vp = page(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">print(glmgg_ded, vp = page(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># bar of default</span></span><br><span class="line"><span class="comment"># ggplot2</span></span><br><span class="line">ggplot(bankloan, aes(x = education, fill = factor(default))) + </span><br><span class="line">  geom_bar(position = <span class="string">&quot;stack&quot;</span>) + </span><br><span class="line">  facet_grid(age_group ~ seniority_group)</span><br></pre></td></tr></table></figure>
<p><del>（3)结合（1)与（2)的操作题，用以上两个操作题中所绘制的图形创建脚本ui.R和server.R,利用shiny包搭建数据可视化平台demo.</del> </p>
<h1 id="第7章-可视化数据挖掘工具Rattle"><a href="#第7章-可视化数据挖掘工具Rattle" class="headerlink" title="第7章 可视化数据挖掘工具Rattle"></a>第7章 可视化数据挖掘工具Rattle</h1><h2 id="1-选择题-6"><a href="#1-选择题-6" class="headerlink" title="1.选择题"></a>1.选择题</h2><p>（1)下列不属于Rattle工具功能的是（C）。<br>A.相关性分析<br>B.周期性分析<br>C.数据集成<br>D.数据变换</p>
<p>（2)Rattle工具不能导入（D）。<br>A.R包的数据<br>B.R工作空间的数据<br>C.R文件的数据<br>D.R命名的数据</p>
<p>（3)如果想要查看数据总体的概况，那么应该运用（A）功能。<br>A. Summary<br>B. Distribution<br>C.Correlation<br>D.Principal Components</p>
<p>（4)Rattle的交互图GGobi包不可以实现（D）的综合使用。<br>A.散点图<br>B.散点矩阵图<br>C.三维图<br>D.星状图</p>
<p>（5)数据建模中，聚类分析不能得到的结果是（C）。<br>A.聚类的结果<br>B.聚类分布图<br>C.聚类的评价<br>D.聚类样本投影图</p>
<p>（6)关联规则的Apriori算法不会默认设置的是（A）。<br>A. Basket<br>B.Support<br>C.Confidence<br>D.Min Length</p>
<p>（7)在Model选项中，分类算法需要设置Min Bucket的值，如果要分成70、15、15的占比，则应该设置为（B）。<br>A.0.7/0.15/0.15<br>B.70/15/15<br>C. 7/1.5/1.5<br>D.70%/15%/15%</p>
<p>（8)Rattle工具的随机森林模型不能得到（D）。<br>A.ROC曲线<br>B.重要性Gini指数<br>C.错误率<br>D.分类树</p>
<p>（9)下列不属于Rattle工具的模型评估方法的是（B）。<br>A.混淆矩阵<br>B.风险评估图<br>C.敏感度与特异性图<br>D.累计增益图</p>
<p>（10)下列数据挖掘算法中，适合用Rale工具的是（C）。<br>A.分类与预测<br>B.聚类分析<br>C.智能推荐<br>D.关联规则</p>
<h2 id="2-操作题-6"><a href="#2-操作题-6" class="headerlink" title="2.操作题"></a>2.操作题</h2><p><del>打开Rattle工具的图形界面，导人Telephone.csv数据，并将数据按照70:15:15的比例分成训练集、验证集和测试集。然后对数据进行探索，完成描述性统计分析、图形探索等操作。提示：在Data选项卡中选择合适的变量构建模型，在Model选项卡中选择合适的分类模型，并对模型进行评估。</del> </p>
<h1 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h1><p><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kav3pl9iOyj6UwJxlDOfnA?pwd=1111">百度网盘–课后习题答案&amp;源代码&amp;数据</a><br>PS：永久有效，自动填充提取码，提取码：1111</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://www.ryjiaoyu.com/book/details/8923">R语言编程基础-图书-人邮教育社区</a> $\rightarrow$ 49611-R语言编程基础-习题数据和答案.rar</p>

  </div>
  
    
      <a id="older" class="blog-nav" href="/2022/10/01/%E3%80%90AI%20Day%E3%80%91/">OLDER&nbsp;&gt;</a>
      
        
          <a id="newer" class="blog-nav" href="/2022/10/05/%E3%80%90RStudio%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E3%80%91%E3%80%90%E4%B8%A4%E4%B8%AA%E6%96%B9%E6%B3%95%E3%80%91/">&lt;&nbsp;NEWER</a>
          
            
</div>
        <div class="footer">
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/leedom92/hexo-theme-leedom">Copyright © Leedom 2021</a>
        
    </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/leedom92/hexo-theme-leedom">Theme by Leedom | Powered by Hexo</a>
        
    </div>
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-box">
        <div class="search-title">
          <!-- <span class="search-icon-input">
            <a href="javascript: void(0)">
              <i class="iconfont icon-search"></i>
            </a>
          </span> -->
          
            <input type="text" class="search-input" id="search-input" placeholder="搜索...">
          
          <span class="search-close-icon" id="search-close-icon">
            <a href="javascript: void(0)">
              <i class="iconfont icon-close"></i>
            </a>
          </span>
        </div>
        <div class="search-result" id="search-result"></div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    // inputArea.onclick = function() {
    //   getSearchFile()
    //   this.onclick = null
    // }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        inputArea.focus()
        getSearchFile()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'><span></ul>";
      // $resultContent.innerHTML = "<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='/" + data_url + "' class='search-result-title'><h2>" + orig_data_title + "</h2></a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<h3 class=\"search-result-abstract\">" + match_content + "...</h3>"
                }
                str += "<hr></li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/leedom92/hexo-theme-leedom#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




    </div>
  </body>
</html>
